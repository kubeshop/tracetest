type: Test
spec:
  id: phAZcrT4A
  name: Playwright - Books list with availability
  description: Testing the books list and availability check
  trigger:
    type: playwrightengine
    playwrightEngine:
      target: http://host.docker.internal:3000/
      script: ./playwright.tracetest.js
      method: bookstore
  specs:
    - selector: span[tracetest.span.type="http" name="GET /books" http.target="/books"
        http.method="GET"]
      assertions:
        - attr:tracetest.span.duration  < 500ms
    - selector: span[tracetest.span.type="general" name="Books List"]
      assertions:
        - attr:books.list.count = 3
    - selector: span[tracetest.span.type="http" name="GET /availability/:bookId" http.method="GET"]
      assertions:
        - attr:http.host = "availability:8082"
    - selector: span[tracetest.span.type="general" name="Availablity check"]
      assertions:
        - attr:isAvailable = "true"
