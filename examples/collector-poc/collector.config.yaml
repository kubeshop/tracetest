receivers:
  otlp:
    protocols:
      grpc:
      http:


processors:
  tail_sampling:
    decision_wait: 5s
    policies:
      - name: tracetest-spans
        type: trace_state
        trace_state: { key: tracetest, values: ["true"] }

  batch:
    timeout: 100ms

exporters:
  logging:
    loglevel: debug

  jaeger:
    endpoint: ${JAEGER_ENDPOINT}
    tls:
      insecure: true

  jaeger/2:
    endpoint: ${JAEGER2_ENDPOINT}
    tls:
      insecure: true

service:
  pipelines:
    # normal pipeline
    traces/1:
      receivers: [otlp]
      processors: [batch]
      exporters: [logging, jaeger]

    # filtered pipeline
    traces/2:
      receivers: [otlp]
      processors: [tail_sampling, batch]
      exporters: [jaeger/2]
