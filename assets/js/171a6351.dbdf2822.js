"use strict";(self.webpackChunktracetest_docs=self.webpackChunktracetest_docs||[]).push([[4578],{61846:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var s=n(74848),a=n(28453);const r={id:"running-tests",title:"Running Tests From the Command Line Interface (CLI)",description:"Run Tracetest Tests from the Command Line Interface (CLI) to integrate it into your CI/CD process or your local development workflow.",keywords:["tracetest","trace-based testing","observability","distributed tracing","testing"],image:"https://res.cloudinary.com/djwdcmwdz/image/upload/v1698686403/docs/Blog_Thumbnail_14_rsvkmo.jpg"},o=void 0,i={id:"cli/running-tests",title:"Running Tests From the Command Line Interface (CLI)",description:"Run Tracetest Tests from the Command Line Interface (CLI) to integrate it into your CI/CD process or your local development workflow.",source:"@site/docs/cli/running-tests.mdx",sourceDirName:"cli",slug:"/cli/running-tests",permalink:"/cli/running-tests",draft:!1,unlisted:!1,editUrl:"https://github.com/kubeshop/tracetest/blob/main/docs/docs/cli/running-tests.mdx",tags:[],version:"current",frontMatter:{id:"running-tests",title:"Running Tests From the Command Line Interface (CLI)",description:"Run Tracetest Tests from the Command Line Interface (CLI) to integrate it into your CI/CD process or your local development workflow.",keywords:["tracetest","trace-based testing","observability","distributed tracing","testing"],image:"https://res.cloudinary.com/djwdcmwdz/image/upload/v1698686403/docs/Blog_Thumbnail_14_rsvkmo.jpg"},sidebar:"tutorialSidebar",previous:{title:"Defining Test Outputs in Text Files",permalink:"/cli/creating-test-outputs"},next:{title:"Undefined Variables",permalink:"/cli/undefined-variables"}},l={},c=[{value:"Running Your First Test",id:"running-your-first-test",level:2},{value:"Running a Test That Uses Variable Sets",id:"running-a-test-that-uses-variable-sets",level:2}];function u(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"Once you have created a test, whether from the Tracetest UI or via a text editor, you will need the capability to run it via the Command Line Interface (CLI) to integrate it into your CI/CD process or your local development workflow."}),"\n",(0,s.jsx)(t.p,{children:"The documentation for running a test via the CLI can be found here:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/cli/reference/tracetest_run",children:"tracetest run"}),": This page provides examples of using this command."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"running-your-first-test",children:"Running Your First Test"}),"\n",(0,s.jsxs)(t.p,{children:["To run a test, give the path to the test definition file with the ",(0,s.jsx)(t.code,{children:"'-f'"})," option. This will launch a test and provide a link to the created test run."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"tracetest run test -f path/to/test.yaml\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-text",metastring:'title="Output:"',children:"\u2718 Pokeshop - Import (http://localhost:11633/test/4oI08rA4g/run/12/test)\n\t\u2714 Response should be ok\n\t\t\u2714 #59ce1f4250482ba5\n\t\t\t\u2714 attr:tracetest.response.status = 200 (200)\n\t\u2714 JSON from external request should have name of 'meowth'\n\t\t\u2714 #efa1be47f04a0d43\n\t\t\t\u2714 attr:http.response.body| json_path '$.name' = \"diglett\" (diglett)\n\t\u2718 Postgres DB queries are fast\n\t\t\u2718 #f062f4d34031279e\n\t\t\t\u2718 attr:tracetest.span.duration < 20ms (23ms) (http://localhost:11633/test/4oI08rA4g/run/12/test?selectedAssertion=2&selectedSpan=f062f4d34031279e)\n\t\t\u2714 #0afed975903f2db5\n\t\t\t\u2714 attr:tracetest.span.duration < 20ms (636us)\n\t\t\u2714 #13ce59129b4e7e31\n\t\t\t\u2714 attr:tracetest.span.duration < 20ms (2ms)\n"})}),"\n",(0,s.jsx)(t.p,{children:"Running the same command with the '-o json' option would change the output from the default of human readable 'pretty' to 'json'. This can be useful when you wish to extract particular data from the response. This would look like:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"tracetest run test -f path/to/test.yaml -o json\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",metastring:'title="Output:"',children:'{\n  "testRunWebUrl": "http://localhost:11633/test/4oI08rA4g/run/13/test",\n  "results": {\n    "results": [\n      {\n        "results": [\n          {\n            "allPassed": true,\n            "assertion": "attr:tracetest.response.status = 200",\n            "spanResults": [\n              {\n                "observedValue": "200",\n                "passed": true,\n                "spanId": "92e4781f4961bbe9"\n              }\n            ]\n          }\n        ],\n        "selector": {\n          "query": "span[tracetest.span.type=\\"general\\" name=\\"Tracetest trigger\\"]",\n          "structure": [\n            {\n              "filters": [\n                {\n                  "operator": "=",\n                  "property": "tracetest.span.type",\n                  "value": "general"\n                },\n                {\n                  "operator": "=",\n                  "property": "name",\n                  "value": "Tracetest trigger"\n                }\n              ]\n            }\n          ]\n        }\n      },\n      {\n        "results": [\n          {\n            "assertion": "attr:http.response.body| json_path \'$.name\' = \\"diglett\\"",\n            "spanResults": [\n              {\n                "error": "no match"\n              }\n            ]\n          }\n        ],\n        "selector": {\n          "query": "span[tracetest.span.type=\\"http\\" name=\\"HTTP GET pokeapi.pokemon\\" http.method=\\"GET\\"]",\n          "structure": [\n            {\n              "filters": [\n                {\n                  "operator": "=",\n                  "property": "tracetest.span.type",\n                  "value": "http"\n                },\n                {\n                  "operator": "=",\n                  "property": "name",\n                  "value": "HTTP GET pokeapi.pokemon"\n                },\n                {\n                  "operator": "=",\n                  "property": "http.method",\n                  "value": "GET"\n                }\n              ]\n            }\n          ]\n        }\n      },\n      {\n        "results": [\n          {\n            "assertion": "attr:tracetest.span.duration \\u003c 20ms",\n            "spanResults": [\n              {\n                "error": "no match",\n                "observedValue": "22ms",\n                "spanId": "1755c8fc14905bd1"\n              },\n              {\n                "observedValue": "574us",\n                "passed": true,\n                "spanId": "c41f9b8f49f6eb32"\n              },\n              {\n                "observedValue": "1ms",\n                "passed": true,\n                "spanId": "48bef78ad4b3c3ab"\n              }\n            ]\n          }\n        ],\n        "selector": {\n          "query": "span[tracetest.span.type=\\"database\\" db.system=\\"postgresql\\"]",\n          "structure": [\n            {\n              "filters": [\n                {\n                  "operator": "=",\n                  "property": "tracetest.span.type",\n                  "value": "database"\n                },\n                {\n                  "operator": "=",\n                  "property": "db.system",\n                  "value": "postgresql"\n                }\n              ]\n            }\n          ]\n        }\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(t.p,{children:"You can also opt to output the result as JUnit to a file. You would run the command with a -j option and a file name, ie:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"tracetest run test -f path/to/test.yaml -j junit.out\n"})}),"\n",(0,s.jsx)(t.p,{children:"The JUnit output file would then contain the JUnit result, for example:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",children:'<testsuites name="Pokeshop - Import" tests="5" failures="1" errors="0" skipped="0" time="10">\n        <testsuite name="span[tracetest.span.type=&#34;general&#34; name=&#34;Tracetest trigger&#34;]" tests="1" failures="0" errors="0" skipped="0">\n                <testcase name="attr:tracetest.response.status = 200"></testcase>\n        </testsuite>\n        <testsuite name="span[tracetest.span.type=&#34;http&#34; name=&#34;HTTP GET pokeapi.pokemon&#34; http.method=&#34;GET&#34;]" tests="1" failures="0" errors="0" skipped="0">\n                <testcase name="attr:http.response.body| json_path &#39;$.name&#39; = &#34;diglett&#34;"></testcase>\n        </testsuite>\n        <testsuite name="span[tracetest.span.type=&#34;database&#34; db.system=&#34;postgresql&#34;]" tests="3" failures="1" errors="0" skipped="0">\n                <testcase name="attr:tracetest.span.duration &lt; 20ms">\n                        <failure type="attr:tracetest.span.duration &lt; 20ms" message="21ms"></failure>\n                </testcase>\n                <testcase name="attr:tracetest.span.duration &lt; 20ms"></testcase>\n                <testcase name="attr:tracetest.span.duration &lt; 20ms"></testcase>\n        </testsuite>\n</testsuites>\n'})}),"\n",(0,s.jsx)(t.h2,{id:"running-a-test-that-uses-variable-sets",children:"Running a Test That Uses Variable Sets"}),"\n",(0,s.jsx)(t.p,{children:"There are two ways of referencing a variable set when running a test."}),"\n",(0,s.jsx)(t.p,{children:"You can reference an existing variable set using its id. For example, given this defined variable set with an id of 'testenv':"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"testenv",src:n(87003).A+"",width:"1736",height:"620"})}),"\n",(0,s.jsx)(t.p,{children:"We can run a test and specify that variable set with this command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"tracetest run test -f path/to/test.yaml -e testenv\n"})}),"\n",(0,s.jsx)(t.p,{children:"You can also reference a variable set resource file which will be used to create a new variable set or update an existing one. For example, if you have a file named local.env with this content:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"type: VariableSet\nspec:\n  id: local.env\n  name: local.env\n  values:\n  - key: POKEID\n    value: 45\n  - key: POKENAME\n    value: vileplume\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"tracetest run test -f path/to/test.yaml --vars path/to/local.env\n"})}),"\n",(0,s.jsx)(t.p,{children:"If you use the variable set resource approach, a new variable set will be created in Tracetest."}),"\n",(0,s.jsx)(t.p,{children:"The second approach is very useful if you are running tests from a CI pipeline."})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},87003:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/show-environment-definition-69ba7aef6b87d684e9e8c311e5197aa0.png"},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var s=n(96540);const a={},r=s.createContext(a);function o(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);